<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title><%= pageTitle %> | LXH Portfolio</title>
  <link rel="stylesheet" href="/css/style.css" />
</head>
<body>
  <%- include("partials/navbar") %>

  <main class="page">
    <section class="contact-card admin-project-card">
      <h2>Add New Project</h2>

      <% if (error) { %>
        <p class="form-error"><%= error %></p>
      <% } %>

      <form
        action="/admin/projects/new"
        method="POST"
        enctype="multipart/form-data"
        class="admin-project-form"
      >
        <label>Project Name</label>
        <input type="text" name="project_name" required />

        <label>Short Description</label>
        <textarea name="project_short_description" required></textarea>

        <label>Project Type</label>
        <select name="project_type" required>
          <option value="">-- Select --</option>
          <option value="development">Development</option>
          <option value="design">Design</option>
        </select>

        <hr />

        <h3>Media</h3>
        <div id="media-list"></div>

        <button type="button" class="btn-add-media" onclick="addMedia()">
          + Add Media
        </button>

        <button type="submit" class="btn-send">
          Save Project
        </button>
      </form>
    </section>
  </main>

  <script>
    function addMedia() {
      const list = document.getElementById("media-list");

      const div = document.createElement("div");
      div.className = "media-item";

      div.innerHTML = `
        <label>Media Type</label>
        <select name="media_type[]" onchange="toggleMedia(this)">
          <option value="">-- Select --</option>
          <option value="file">Upload File</option>
          <option value="youtube">YouTube</option>
        </select>

        <div class="file-input" style="display:none;">
          <input type="file" name="media_files[]" />
        </div>

        <div class="yt-input" style="display:none;">
          <input type="text" name="media_youtube[]" placeholder="YouTube URL" />
        </div>

        <input type="text" name="media_desc[]" placeholder="Caption (optional)" />
        <hr />
      `;

      list.appendChild(div);
    }

    function toggleMedia(select) {
      const block = select.closest(".media-item");
      block.querySelector(".file-input").style.display =
        select.value === "file" ? "block" : "none";
      block.querySelector(".yt-input").style.display =
        select.value === "youtube" ? "block" : "none";
    }
  </script>

  <%- include("partials/footer") %>
</body>
</html>
